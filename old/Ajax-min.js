function Ajax(a,c,e,d,b){this.url=a||"";this.data=c||"";this.callback=e||function(f){return f};this.method=d||"POST";this.async=b||true;this.factories=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}]}Ajax.prototype.object=function(){var b,a,f,c;c=this;b=false;for(a=0;a<this.factories.length;a=a+1){f=false;try{b=this.factories[a]()}catch(d){f=true}if(!f){break}}if(b!==null){b.onreadystatechange=function(){var e=true;if(b.readyState!==4){e=false}if(b.status!==200&&b.status!==304){e=false}if(e){c.callback(b)}}}if(b!==null){return b}};Ajax.prototype.update=function(a){var b=false;if(typeof this.object==="function"){this.object=this.object()}if(typeof this.object==="object"){if(a!==undefined||a!==null){if(this.method==="post"||this.method==="POST"){this.object.open(this.method,this.url,this.async);this.object.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.object.send(a)}else{if(this.method==="get"||this.method==="GET"){this.object.open(this.method,this.url+a,this.async);this.object.send(null)}}b=true}else{if(this.data!==""){if(this.method==="post"||this.method==="POST"){this.object.open(this.method,this.url,this.async);this.object.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.object.send(this.data)}else{if(this.method==="get"||this.method==="GET"){this.object.open(this.method,this.url+this.data,this.async);this.object.send(null)}}b=true}else{this.object.send(null);b=true}}}return b};